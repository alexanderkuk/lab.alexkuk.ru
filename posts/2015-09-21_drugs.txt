Тысяча и один блистер. Поиск лекарств с завышенной ценой

Недавно Минздрав выложил <a href="https://www.rosminzdrav.ru/opendata/7707778246-Gos%20reestr%20predel'nyh%20otpusknyh%20cen">таблицу с предельными ценами на жизненно необходимые лекарства</a>, я неслабо заморочился и проверил как часто эти пределы в Москве превышаются.

<img src="https://habrastorage.org/files/d2a/c0e/b9c/d2ac0eb9cde749d38cb1e5f38ec4a85a"/>
<cut/>
Идея была такая: взять цены на лекарства, которые доступны в интернете на <a href="http://med.sputnik.ru">Спутнике</a>, <a href="http://aptekamos.ru/apteka/">aptekamos.ru</a> или <a href="http://www.poisklekarstv.ru/">poisklekarstv.ru</a> как-то их объединить с предельными ценами и посмотреть часто ли случаются превышения.

Сначала про <a href="https://www.rosminzdrav.ru/opendata/7707778246-Gos%20reestr%20predel'nyh%20otpusknyh%20cen">реестр, который выложил Минздрав</a>: во-первых, оказалось, что эти данные всю жизнь были доступны на <a href="http://grls.rosminzdrav.ru/PriceLims.aspx">grls.rosminzdrav.ru</a>. Они там каждый день обновляются и представлены в виде аккуратного эксель-файла. Поэтому, <a href="https://github.com/alexanderkuk/analyze-drug-price/blob/master/main.py#L41-L78">намучавшись с табличкой, которую выложил Минздрав</a>, я перешёл на данные ГРЛСа. Датасет выглядел так:

<img src="https://habrastorage.org/files/a2b/0ee/34a/a2b0ee34ad96446f85cef5ee2baa1c3a"/>

В список жизненно необходимых входит ~3200 лекарств, но с учётом разных форм, дозировок и производителей получается ~20 000 наименований. Для каждого указана максимальная цена, по-которой производитель может продавать лекарство оптовикам. Здесь важно отметить, что указана максимальная цена именно для производителя, а не для аптеки. На ценнике на витрине значение может быть гораздо выше за счёт налогов, оптовых и розничных надбавок, но об этом позже.

Дальше нужно было для каждой из ~20 000 позиций найти цены, которые имеют место быть в аптеках столицы. Для этого я взял прекрасный сайт <a href="http://med.sputnik.ru/#lat=55.7516&lon=37.6187&zoom=13">Спутник/Медицина</a> и, указывая одно лекарство за другим, собрал все цены. 200 названий найти не удалось, для 800 препаратов не нашлось аптек, которые бы их продавали. Таким образом количество наименований, для которых потенциально можно было бы найти аптечные цены, резко сократилось c ~20 000 до ~8000. Не думаю, что это плохо, видимо, остальные позиции совсем непопулярные, если не встречаются в аптеках Москвы. Можно ещё предположить, что лекарства продаются, но Спутник о них не знает. Возможно. Но покрытие аптек у этого сервиса по моим оценкам примерно 25%, что немало. Если цен нет, значит препарат правда непопулярный.

Затем началось самое интересное, лекарства нужно было объединить по формам и дозировкам. Естественно, написание там везде разное, поэтому пришлось разобраться, что такое "д/в/в", "д/эндотрахеального", "д/п/к" и "д/в/м", учесть, что "10 тыс.КИЕ/мл" — это то же самое, что "10 000 КИЕ/мл" и "1 г+62.5 мг" не отличается от "1 000 мг+62.5 мг". В итоге 75% форм и дозировок удалось объединить, что неплохо.

Дальше я нарисовал для каждого лекарства небольшую картинку вида:

<img src="https://habrastorage.org/files/c3f/dcf/d7d/c3fdcfd7d3684625913d4fe0fe92af12"/>

На ней каждая аптечная цена представлена синей полосочкой, случаи превышения отмечены красным. Почти для всех препаратов я наблюдал жёсткие превышения в больших количествах. Тогда я ещё не знал, сколько всего нужно учесть, чтобы правильно посчитать предельную цену.

Во-первых у лекарства бывают разные производители, нужно брать самый дорогой из них. Обязательно нужно учитывать налоги, оптовую и розничную надбавки. Например, 30 капсул «Тулозина» производитель может продавать за <a href="http://grls.rosminzdrav.ru/PriceLims.aspx?PageSize=99&&Torg=%D0%A2%D1%83%D0%BB%D0%BE%D0%B7%D0%B8%D0%BD">471.89р. или дешевле</a>. <a href="http://www.fstrf.ru/press/news/1950/">Оптовые и розничные надбавки</a> разные для разных ценовых категорий. Для московских аптек для ценовой категории «до 500р.» оптовая надбавка составляет 15%, розничная — 28%. Поэтому добавляем к 471.89р. 43%, получаем 674.80р. Если аптека организована юридическим лицом, а не индивидуальным предпринимателем, то налогом облагаются и оптовая, и розничная надбавки, поэтому добавляем к 674.80р 10% и получаем 742.28р. В общем случае зависимость максимального значения на ценнике от предельной цены производителя выглядит так:

<img src="https://habrastorage.org/files/961/7b4/8ce/9617b48ce2a34abbab8e623481d69a8c"/>

Важно отметить, что аптека не может играть на цене за счёт ступеньки на графике. Если предельная цена препарата, например, 502р., то он попадает в категорию «от 500р.». Не важно, что аптека купила его за 499р. сделать наценки, как в категории «до 500р.» она не может.

Почти всё. Нужно только ещё учесть, что цены в реестре иногда меняются. Бывает даже так, что они уменьшаются (четыре полоски ниже единицы на картинке снизу), поэтому нужно выкачать весь архив реестра и брать максимальную цену за весь период.

<img src="https://habrastorage.org/files/649/d19/617/649d196178b94e1e9ccaddff5db08334"/>

После того как были учтены все тонкости, число препаратов с превышением значительно упало и стало составлять примерно 5%. Это немного и превышения там обычно были небольшие, но я всё равно решил походить по аптекам, проверить правильно ли всё работает.

Нанёс аптеки с превышениями на карту и зашёл в пять из них:

<img src="https://habrastorage.org/files/b9a/478/ea9/b9a478ea993e452cbb85525f7d575bfc"/>

В трёх, действительно, были превышения:

<video>http://www.youtube.com/watch?v=blvYoCHzOtI</video>

Чтобы быть совсем уверенным и за одно получить ачивок, я накатал жалобы на <a href="http://gorod.mos.ru/">gorod.mos.ru</a> и сейчас там ими даже кто-то занимается:

<img src="https://habrastorage.org/files/01e/e00/850/01ee00850e54477f84c6e5271fbcb55b"/>

Потом благодаря Линькову Юрию и Василию Пушкину, с которыми я познакомился на хакатоне по открытым данным, удалось пообщаться с людьми, которые в теме. Сходили в Аналитический центр при Правительстве РФ, там превышениями в целом не занимаются им больше интересна общая динамика цен. Были в Минздраве, им не очень понравилась интонация, штрафовать там никто никого не хочет. Сотрудники Минздравнадзора сказали, что определять максимальную цену автоматически нельзя и "к каждому случаю нужен особый подход", они занимаются этим уже много лет. Представители Ассоциации аптечных сетей и одной крупной коммерческой сети не поверили в существование сколько угодно крупных превышений, они на практике знают, как тщательно аптеки проверяют контролирующие органы. Места нарушениям там почти не остаётся.

Тем не менее, все наработки были оформлены в виде примитивного справочника <a href="http://1001blister.ru/">1001blister.ru</a>. Данные о ценах там представлены в супер-агрегированном виде, потому что Спутник, естественно, не может ими делиться. Упоминания каких-либо аптек отсутствуют. Справочник можно использовать, чтобы узнать максимальные цены на препараты, которыми регулярно пользуешься. Говорят, иногда фармацевты в аптеках начинают предлагать скидки, когда называешь установленную законом предельную цену.
